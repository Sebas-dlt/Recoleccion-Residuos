{% extends "main/layout.html" %}

{% block content %}
{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/driver-dashboard.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/pickups.css') }}">
{% endblock %}

<div class="driver-header">
    <div>
        <h1>Panel del Conductor</h1>
        <div style="font-size: 0.9rem; opacity: 0.9">Sistema de Gestión de Residuos</div>
    </div>
    <nav class="driver-nav">
        <a href="#rutas">Rutas Activas</a>
        <a href="#recolecciones">Recolecciones</a>
        <a href="#estado">Mi Estado</a>
        <a href="#reportes">Reportes</a>
        <a href="/logout" class="logout-btn">Cerrar Sesión</a>
    </nav>
</div>

<div class="driver-container">
    <!-- Estado Actual -->
    <section class="driver-card" id="estado">
        <h3>Estado Actual</h3>
        <div class="status-grid">
            <div class="status-item">
                <span class="status-label">Estado:</span>
                <span class="status-value active">En Servicio</span>
            </div>
            <div class="status-item">
                <span class="status-label">Ruta Actual:</span>
                <span class="status-value">Zona Norte #123</span>
            </div>
            <div class="status-item">
                <span class="status-label">Recolecciones Hoy:</span>
                <span class="status-value">12/20</span>
            </div>
        </div>
    </section>

    <!-- Mapa de Ruta -->
    <section class="driver-card" id="rutas">
        <h3>Ruta Actual</h3>
        <div id="route-map" style="height: 400px; border-radius: 8px; margin-top: 1rem;"></div>
        <div class="route-controls">
            <button class="route-btn start">
                <i class="fas fa-play"></i>
                Iniciar Ruta
            </button>
            <button class="route-btn complete">
                <i class="fas fa-check"></i>
                Completar Punto
            </button>
            <button class="route-btn end">
                <i class="fas fa-flag-checkered"></i>
                Finalizar Ruta
            </button>
        </div>
    </section>

    <!-- Lista de Recolecciones -->
    <section class="driver-card" id="recolecciones">
        <h3>Recolecciones Pendientes</h3>
        <div class="collection-list" id="collectionList">
            <!-- Incluir partial de recolecciones (driver) -->
            {% set pickups_role = 'driver' %}
            {% include 'views/_pickups_partial.html' %}
        </div>
    </section>
</div>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>

<!-- Driver external JS -->
<script src="{{ url_for('static', filename='js/driver-dashboard.js') }}"></script>
{% block scripts_extra %}
<script src="{{ url_for('static', filename='js/pickups.js') }}"></script>
{% endblock %}

{% endblock %}