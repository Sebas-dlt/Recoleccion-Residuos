
{% extends "/main/layout.html" %}

{% block content %}
{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">
{% endblock %}

<div class="login-header">
    <h1>Recolección Inteligente</h1>
    <div class="subtitle">Sistema de Gestión de Residuos</div>
</div>

<div class="login-container">
    <div class="login-card">
        <h2 style="margin-bottom: 20px; color: #1a1a1a; text-align: center;">Iniciar Sesión</h2>
        <form id="myform">
            <input type="hidden" name="csrf_token" value="{{csrf_token}}">
            
            <input type="email" 
                   class="form-control-custom"
                   id="exampleInputEmail" 
                   name="exampleInputEmail" 
                   placeholder="Correo electrónico">
            
            <input type="password" 
                   class="form-control-custom"
                   id="exampleInputPassword" 
                   name="exampleInputPassword" 
                   placeholder="Contraseña">
            
            <button type="submit" class="login-btn">
                Iniciar Sesión
            </button>
        </form>
    </div>
    
    <div class="login-footer">
        <div>Credenciales de prueba:</div>
        <div style="margin-top: 8px">
            <strong>Admin:</strong> admin@admin.com / admin123<br>
            <strong>Usuario:</strong> user@user.com / user123<br>
            <strong>Conductor:</strong> driver@driver.com / driver123
        </div>
    </div>
</div>

<script>
document.getElementById('myform').addEventListener('submit', function(e) {
    e.preventDefault();
    
    fetch('/submit', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'X-CSRF-Token': document.querySelector('input[name="csrf_token"]').value
        },
        body: new URLSearchParams(new FormData(this))
    })
    .then(response => response.json())
    .then(data => {
        if(data.status === 200) {
            window.location.href = data.url;
        } else {
            alert(data.message || 'Error de autenticación');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error al procesar la solicitud');
    });
});
</script>

{% endblock %}
